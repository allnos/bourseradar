<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALLNOS Radar : Valeurs d'Or Buffett</title>
    <style>
        /* Styles généraux */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; margin: 0; padding: 20px; color: #34495e; }
        .container { max-width: 1400px; margin: 0 auto; background: white; padding: 30px 40px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; text-align: center; margin-bottom: 5px; font-size: 2.5em; }
        h2 { color: #2c3e50; border-bottom: 2px solid #ecf0f1; padding-bottom: 10px; margin-top: 40px; }
        p { line-height: 1.6; margin-bottom: 20px; font-size: 1.1em; }
        .update-time { text-align: center; color: #7f8c8d; font-size: 0.9em; margin-bottom: 25px; }

        /* Tableau */
        table { width: 100%; border-collapse: collapse; margin-top: 30px; }
        th { background: #34495e; color: white; padding: 14px; text-align: left; font-size: 1em; }
        td { padding: 14px; border-bottom: 1px solid #eee; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #e8f4f8; }

        /* Tags & Ratios */
        .ratio-tag { 
            padding: 4px 8px; 
            border-radius: 4px; 
            font-weight: bold; 
            color: white; 
            font-size: 0.9em; 
            display: inline-block; 
            text-align: center; 
            min-width: 60px;
        }
        .tag-value { font-size: 0.8em; padding: 2px 6px; border-radius: 3px; margin-top: 4px; display: inline-block; }
        .tag-valeur-dor { background-color: #f1c40f; color: #2c3e50; font-weight: bold; } 
        .indicator-good { background-color: #27ae60; } 
        .indicator-na { background-color: #95a5a6; } 

        /* Tableau Storytelling */
        .criteria-table { width: 100%; margin-bottom: 30px; border: 1px solid #ddd; }
        .criteria-table th, .criteria-table td { padding: 15px; text-align: left; border-bottom: 1px solid #eee; }
        .criteria-table th { background-color: #ecf0f1; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    
    <h1>Déjouez le Bruit du Marché. **Investissez comme un Légende.**</h1>
    <p class="update-time" id="lastUpdate">Chargement des données...</p>

    <p style="text-align: center; font-size: 1.2em; font-weight: 300; margin-bottom: 50px;">
        Fatigué(e) des tendances éphémères ? L'équipe d'ALLNOS a codé les principes d'investissement les plus durables au monde. Notre mission : vous révéler 
        **les "Valeurs d'Or"** que même Warren Buffett ne pourrait ignorer.
    </p>

    <h2>Le Secret des Plus Grands Riches</h2>
    <p>
        Warren Buffett l'a dit : "Le prix est ce que vous payez. La valeur est ce que vous recevez." 
        Notre outil sélectionne les entreprises de haute **Qualité**, peu endettées, disponibles à un bon **Prix**.
    </p>

    <table class="criteria-table">
        <thead>
            <tr>
                <th>Critère Fondamental</th>
                <th>Ratio Clé</th>
                <th>Seuil Buffett</th>
                <th>La Preuve de Qualité</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>**Qualité**</td>
                <td>Return on Equity (ROE)</td>
                <td>**> 15%**</td>
                <td>L'entreprise génère d'excellents bénéfices avec les fonds des actionnaires.</td>
            </tr>
            <tr>
                <td>**Sécurité**</td>
                <td>Dette / Capitaux Propres (D/E)</td>
                <td>**< 1.0**</td>
                <td>La dette est gérable (Sauf Banques/Services Publics).</td>
            </tr>
            <tr>
                <td>**Moat / Pouvoir de Prix**</td>
                <td>Marge Brute (GPM)</td>
                <td>**> 20%**</td>
                <td>L'entreprise a un avantage concurrentiel lui permettant de fixer ses prix.</td>
            </tr>
            <tr>
                <td>**Prix d'Achat**</td>
                <td>P/E Ratio</td>
                <td>**< 15**</td>
                <td>L'action est sous-évaluée ou justement valorisée.</td>
            </tr>
        </tbody>
    </table>

    <h2>Cessez de Chercher. Commencez à Sélectionner.</h2>
    <p>Chaque "**Valeur d'Or**" ci-dessous a franchi ces quatre barrières (ou bénéficie d'une exception sectorielle validée).</p>

    <table id="stockTable">
        <thead>
            <tr>
                <th>Symbole / Type</th>
                <th>Société</th>
                <th>Secteur</th>
                <th>P/E Ratio (< 15)</th>
                <th>ROE (> 15%)</th>
                <th>Marge Brute (> 20%)</th>
                <th>Dette/Eq (< 1.0)</th>
                <th>Prix</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>
</div>

<script>
    fetch('data.json')
        .then(response => response.json())
        .then(jsonData => {
            document.getElementById('lastUpdate').textContent = `Dernière mise à jour : ${jsonData.last_updated} | ${jsonData.data.length} actions trouvées.`;
            
            const tbody = document.getElementById('tableBody');
            
            if(jsonData.data.length === 0) {
                tbody.innerHTML = "<tr><td colspan='8' style='text-align:center; padding: 30px;'>Aucune 'Valeur d'Or' trouvée aujourd'hui.</td></tr>";
                return;
            }

            jsonData.data.forEach(stock => {
                const tagClass = "tag-valeur-dor";
                
                // Formatage sécurisé des données
                const peVal = stock.pe ? stock.pe.toFixed(2) : 'N/A';
                const roeVal = stock.roe ? stock.roe.toFixed(2) + '%' : 'N/A';
                const gpmVal = stock.gpm ? stock.gpm.toFixed(2) + '%' : 'N/A';
                const deVal = stock.de_ratio ? stock.de_ratio.toFixed(2) : 'N/A';
                const priceVal = stock.price ? `${stock.price.toFixed(2)} ${stock.currency}` : 'N/A';

                const row = `<tr>
                    <td>
                        <b>${stock.symbol}</b><br>
                        <span class="tag-value ${tagClass}">${stock.tag}</span>
                    </td>
                    <td>${stock.name}</td>
                    <td>${stock.sector}</td>
                    <td><span class="ratio-tag indicator-good">${peVal}</span></td>
                    <td><span class="ratio-tag indicator-good">${roeVal}</span></td>
                    <td><span class="ratio-tag indicator-good">${gpmVal}</span></td>
                    <td><span class="ratio-tag indicator-good">${deVal}</span></td>
                    <td>${priceVal}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        })
        .catch(error => {
            document.getElementById('lastUpdate').textContent = "Erreur : fichier data.json introuvable.";
        });
</script>

</body>
</html>
